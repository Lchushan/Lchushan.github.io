<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>js | Liang&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="我的个人网站">
    
    <link rel="preload" href="/assets/css/0.styles.64852305.css" as="style"><link rel="preload" href="/assets/js/app.8914b41c.js" as="script"><link rel="preload" href="/assets/js/3.7f8ab6bd.js" as="script"><link rel="preload" href="/assets/js/73.ff13867e.js" as="script"><link rel="prefetch" href="/assets/js/10.12b4bf37.js"><link rel="prefetch" href="/assets/js/11.986ec194.js"><link rel="prefetch" href="/assets/js/12.127689ae.js"><link rel="prefetch" href="/assets/js/13.528417d2.js"><link rel="prefetch" href="/assets/js/14.ccd1b44f.js"><link rel="prefetch" href="/assets/js/15.df2ae387.js"><link rel="prefetch" href="/assets/js/16.7bbe874c.js"><link rel="prefetch" href="/assets/js/17.4b65eca3.js"><link rel="prefetch" href="/assets/js/18.b4f5604c.js"><link rel="prefetch" href="/assets/js/19.ada119ee.js"><link rel="prefetch" href="/assets/js/2.f7dde802.js"><link rel="prefetch" href="/assets/js/20.d063279a.js"><link rel="prefetch" href="/assets/js/21.d15b3ac7.js"><link rel="prefetch" href="/assets/js/22.5185a1a5.js"><link rel="prefetch" href="/assets/js/23.91b5f7c4.js"><link rel="prefetch" href="/assets/js/24.545bc1fb.js"><link rel="prefetch" href="/assets/js/25.ce0688e9.js"><link rel="prefetch" href="/assets/js/26.14f7ddb2.js"><link rel="prefetch" href="/assets/js/27.1d380883.js"><link rel="prefetch" href="/assets/js/28.84fd7342.js"><link rel="prefetch" href="/assets/js/29.977a10c6.js"><link rel="prefetch" href="/assets/js/30.e27d5c6c.js"><link rel="prefetch" href="/assets/js/31.fef44b40.js"><link rel="prefetch" href="/assets/js/32.3cde5ab7.js"><link rel="prefetch" href="/assets/js/33.2fd0f2f0.js"><link rel="prefetch" href="/assets/js/34.6174b407.js"><link rel="prefetch" href="/assets/js/35.3457d0d3.js"><link rel="prefetch" href="/assets/js/36.c672256a.js"><link rel="prefetch" href="/assets/js/37.c5336199.js"><link rel="prefetch" href="/assets/js/38.f878aa15.js"><link rel="prefetch" href="/assets/js/39.7272608e.js"><link rel="prefetch" href="/assets/js/4.591798d0.js"><link rel="prefetch" href="/assets/js/40.1f5087ab.js"><link rel="prefetch" href="/assets/js/41.d8defd1f.js"><link rel="prefetch" href="/assets/js/42.4decf61e.js"><link rel="prefetch" href="/assets/js/43.1f54a9fb.js"><link rel="prefetch" href="/assets/js/44.05628c46.js"><link rel="prefetch" href="/assets/js/45.b64569a4.js"><link rel="prefetch" href="/assets/js/46.3e758616.js"><link rel="prefetch" href="/assets/js/47.754e4534.js"><link rel="prefetch" href="/assets/js/48.d7707287.js"><link rel="prefetch" href="/assets/js/49.c62b8419.js"><link rel="prefetch" href="/assets/js/5.ae5a8b30.js"><link rel="prefetch" href="/assets/js/50.60fbaa68.js"><link rel="prefetch" href="/assets/js/51.812c8fc9.js"><link rel="prefetch" href="/assets/js/52.bae4e31b.js"><link rel="prefetch" href="/assets/js/53.bdcc492b.js"><link rel="prefetch" href="/assets/js/54.c9eece36.js"><link rel="prefetch" href="/assets/js/55.bec15e04.js"><link rel="prefetch" href="/assets/js/56.3e4a4b07.js"><link rel="prefetch" href="/assets/js/57.300f3929.js"><link rel="prefetch" href="/assets/js/58.9b3bc2f8.js"><link rel="prefetch" href="/assets/js/59.b4f2f65a.js"><link rel="prefetch" href="/assets/js/6.c6d5d1da.js"><link rel="prefetch" href="/assets/js/60.6da1c705.js"><link rel="prefetch" href="/assets/js/61.0f431e1e.js"><link rel="prefetch" href="/assets/js/62.ca980bdb.js"><link rel="prefetch" href="/assets/js/63.b1d0e0d0.js"><link rel="prefetch" href="/assets/js/64.a5dc88b1.js"><link rel="prefetch" href="/assets/js/65.2134e59f.js"><link rel="prefetch" href="/assets/js/66.2ce26325.js"><link rel="prefetch" href="/assets/js/67.be6c5ba6.js"><link rel="prefetch" href="/assets/js/68.5ee46489.js"><link rel="prefetch" href="/assets/js/69.817ef5b5.js"><link rel="prefetch" href="/assets/js/7.39a2feef.js"><link rel="prefetch" href="/assets/js/70.bd026d5e.js"><link rel="prefetch" href="/assets/js/71.94cd51c9.js"><link rel="prefetch" href="/assets/js/72.2852256c.js"><link rel="prefetch" href="/assets/js/74.d43a4484.js"><link rel="prefetch" href="/assets/js/75.8a138783.js"><link rel="prefetch" href="/assets/js/76.75869419.js"><link rel="prefetch" href="/assets/js/77.85ccf9b3.js"><link rel="prefetch" href="/assets/js/78.d1f93c97.js"><link rel="prefetch" href="/assets/js/79.476c7345.js"><link rel="prefetch" href="/assets/js/8.6aa44381.js"><link rel="prefetch" href="/assets/js/80.75df788e.js"><link rel="prefetch" href="/assets/js/81.8dabfdfb.js"><link rel="prefetch" href="/assets/js/82.b373d124.js"><link rel="prefetch" href="/assets/js/83.543e5130.js"><link rel="prefetch" href="/assets/js/84.551d04d7.js"><link rel="prefetch" href="/assets/js/85.21a99aad.js"><link rel="prefetch" href="/assets/js/9.ab9a5c08.js">
    <link rel="stylesheet" href="/assets/css/0.styles.64852305.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Liang's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link">
  vuepress
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端知识" class="dropdown-title"><span class="title">前端知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端知识" class="mobile-dropdown-title"><span class="title">前端知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/插件小技巧/" class="nav-link">
  插件小技巧
</a></li><li class="dropdown-item"><!----> <a href="/前端问题/" class="nav-link">
  前端问题
</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link">
  vue问题
</a></li><li class="dropdown-item"><!----> <a href="/react/" class="nav-link">
  react问题
</a></li><li class="dropdown-item"><!----> <a href="/优化问题/" class="nav-link">
  优化问题
</a></li><li class="dropdown-item"><!----> <a href="/node/" class="nav-link">
  node
</a></li><li class="dropdown-item"><!----> <a href="/webpack/" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/regular&amp;git/regular/" class="nav-link">
  正则&amp;git
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="画图小软件" class="dropdown-title"><span class="title">画图小软件</span> <span class="arrow down"></span></button> <button type="button" aria-label="画图小软件" class="mobile-dropdown-title"><span class="title">画图小软件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/three.js/" class="nav-link">
  three.js
</a></li><li class="dropdown-item"><!----> <a href="/eChart/" class="nav-link">
  eChart
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微前端" class="dropdown-title"><span class="title">微前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="微前端" class="mobile-dropdown-title"><span class="title">微前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/qiankun/" class="nav-link">
  qiankun
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/progress/" class="nav-link">
  记录问题
</a></li><li class="dropdown-item"><!----> <a href="/小案例/" class="nav-link">
  小案例
</a></li></ul></div></div><div class="nav-item"><a href="https://gitee.com/Lchu3/lchushan" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link">
  vuepress
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端知识" class="dropdown-title"><span class="title">前端知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端知识" class="mobile-dropdown-title"><span class="title">前端知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/插件小技巧/" class="nav-link">
  插件小技巧
</a></li><li class="dropdown-item"><!----> <a href="/前端问题/" class="nav-link">
  前端问题
</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link">
  vue问题
</a></li><li class="dropdown-item"><!----> <a href="/react/" class="nav-link">
  react问题
</a></li><li class="dropdown-item"><!----> <a href="/优化问题/" class="nav-link">
  优化问题
</a></li><li class="dropdown-item"><!----> <a href="/node/" class="nav-link">
  node
</a></li><li class="dropdown-item"><!----> <a href="/webpack/" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/regular&amp;git/regular/" class="nav-link">
  正则&amp;git
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="画图小软件" class="dropdown-title"><span class="title">画图小软件</span> <span class="arrow down"></span></button> <button type="button" aria-label="画图小软件" class="mobile-dropdown-title"><span class="title">画图小软件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/three.js/" class="nav-link">
  three.js
</a></li><li class="dropdown-item"><!----> <a href="/eChart/" class="nav-link">
  eChart
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微前端" class="dropdown-title"><span class="title">微前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="微前端" class="mobile-dropdown-title"><span class="title">微前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/qiankun/" class="nav-link">
  qiankun
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/progress/" class="nav-link">
  记录问题
</a></li><li class="dropdown-item"><!----> <a href="/小案例/" class="nav-link">
  小案例
</a></li></ul></div></div><div class="nav-item"><a href="https://gitee.com/Lchu3/lchushan" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>前端问题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/%E5%89%8D%E7%AB%AF%E9%97%AE%E9%A2%98/" aria-current="page" class="sidebar-link">前端问题</a></li><li><a href="/前端问题/前端基础/jsBase.html" class="active sidebar-link">js基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#iframe子页面跳转-父页面跳出子页面返回上一页" class="sidebar-link">iframe子页面跳转，父页面跳出子页面返回上一页</a></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#date日期对象" class="sidebar-link">Date日期对象</a></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#js随机生成1-100的数" class="sidebar-link">js随机生成1-100的数</a></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#js下载文档" class="sidebar-link">js下载文档</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#window-open下载文件" class="sidebar-link">window.open下载文件</a></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#a标签下载文件" class="sidebar-link">a标签下载文件</a></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#input标签下载文件" class="sidebar-link">input标签下载文件</a></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#axios下载文件" class="sidebar-link">axios下载文件</a></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#xhr下载文件" class="sidebar-link">xhr下载文件</a></li></ul></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#js计算字符串的长度" class="sidebar-link">js计算字符串的长度</a></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#数字要用千分位来表示-三位数之间要用逗号分隔" class="sidebar-link">数字要用千分位来表示，三位数之间要用逗号分隔</a></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#对数据进行重新排序" class="sidebar-link">对数据进行重新排序</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#对象数组的排序" class="sidebar-link">对象数组的排序</a></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#自定义数据进行排列" class="sidebar-link">自定义数据进行排列</a></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#数组从大到小排序-去除重复值" class="sidebar-link">数组从大到小排序，去除重复值</a></li></ul></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#循环的终止" class="sidebar-link">循环的终止</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#break和continue的区别" class="sidebar-link">break和continue的区别</a></li></ul></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#xss攻击防范" class="sidebar-link">XSS攻击防范</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#前端安全系列之xss攻击防范" class="sidebar-link">前端安全系列之xss攻击防范</a></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#v-html防止xss注入" class="sidebar-link">v-html防止xss注入</a></li></ul></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#this相关" class="sidebar-link">this相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#call-apply-bind-的区别和作用-bind-方法如何来实现" class="sidebar-link">call(), .apply() .bind() 的区别和作用？bind 方法如何来实现？</a></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#如何判断this-箭头函数的this是什么" class="sidebar-link">如何判断this？箭头函数的this是什么？</a></li></ul></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#js-禁止退出当前页面" class="sidebar-link">js 禁止退出当前页面</a></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#清除网页历史记录-屏蔽后退按钮" class="sidebar-link">清除网页历史记录，屏蔽后退按钮!</a></li><li class="sidebar-sub-header"><a href="/前端问题/前端基础/jsBase.html#微信链接重定向之后后退两次才能退出当前页面问题解决" class="sidebar-link">微信链接重定向之后后退两次才能退出当前页面问题解决</a></li></ul></li><li><a href="/前端问题/前端基础/htmlBase.html" class="sidebar-link">html基础</a></li><li><a href="/前端问题/前端基础/cssBase.html" class="sidebar-link">css基础</a></li><li><a href="/前端问题/前端基础/canvas.html" class="sidebar-link">canvas</a></li><li><a href="/前端问题/前端请求接口的几种方式总结.html" class="sidebar-link">前端请求接口的几种方式总结</a></li><li><a href="/前端问题/ArrObjStr.html" class="sidebar-link">数组/对象/字符串</a></li><li><a href="/前端问题/递归.html" class="sidebar-link">递归</a></li><li><a href="/前端问题/跳转相关.html" class="sidebar-link">跳转相关</a></li><li><a href="/前端问题/模拟数据.html" class="sidebar-link">模拟数据</a></li><li><a href="/前端问题/刷新页面.html" class="sidebar-link">刷新页面</a></li><li><a href="/前端问题/瀑布流.html" class="sidebar-link">瀑布流</a></li><li><a href="/前端问题/悬浮小图标.html" class="sidebar-link">悬浮小图标</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="js"><a href="#js" class="header-anchor">#</a> <code>js</code></h1> <h2 id="iframe子页面跳转-父页面跳出子页面返回上一页"><a href="#iframe子页面跳转-父页面跳出子页面返回上一页" class="header-anchor">#</a> iframe子页面跳转，父页面跳出子页面返回上一页</h2> <p>保留当前的历史记录的length</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">rlen</span><span class="token operator">:</span> history<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>事件：把iframe清除，并计算需要回退的页面</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">removeChildIframes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> iframes <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&quot;iframe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> iframes<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        iframes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>iframes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> len <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>rlen <span class="token operator">-</span> history<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// -1是不进入iframe页面的下级页面直接退出的话，执行后退一步的操作</span>
        window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="date日期对象"><a href="#date日期对象" class="header-anchor">#</a> Date日期对象</h2> <p><code>W3C</code> <a href="https://www.w3school.com.cn/js/js_dates.asp" target="_blank" rel="noopener noreferrer">https://www.w3school.com.cn/js/js_dates.asp<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><code>layDate</code> 日期与时间组件 <a href="https://www.layui.com/laydate/" target="_blank" rel="noopener noreferrer">https://www.layui.com/laydate/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>创建日期对象语法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> now <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>时间的获取</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> now <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> nian <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">// 从日期对象中获取年份</span>
<span class="token keyword">var</span> nian <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>   <span class="token comment">// 从日期对象中获取月份</span>
<span class="token keyword">var</span> nian <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">// 从日期对象中获取日  </span>
<span class="token keyword">var</span> nian <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">// 从日期对象中获取小时 </span>
<span class="token keyword">var</span> nian <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">// 从日期对象中获取分</span>
<span class="token keyword">var</span> nian <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">// 从日期对象中获取秒</span>
<span class="token keyword">var</span> nian <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getMilliseconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">// 从日期对象中获取毫秒</span>
<span class="token keyword">var</span> nian <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span>   <span class="token comment">// 从日期对象中获取季度</span>
</code></pre></div><h4 id="将当前的日期转换为-年月日-的格式"><a href="#将当前的日期转换为-年月日-的格式" class="header-anchor">#</a> 将当前的日期转换为&quot;年月日&quot;的格式</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 转换成 年月日时分秒 这种格式：yyyy-MM-dd hh:mm:ss 或者 yyyy-MM-dd</span>
<span class="token class-name">Date</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">format</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fmt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span> 
        <span class="token string-property property">&quot;M+&quot;</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>                 <span class="token comment">//月份 </span>
        <span class="token string-property property">&quot;d+&quot;</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token comment">//日 </span>
        <span class="token string-property property">&quot;h+&quot;</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                   <span class="token comment">//小时 </span>
        <span class="token string-property property">&quot;m+&quot;</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                 <span class="token comment">//分 </span>
        <span class="token string-property property">&quot;s+&quot;</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                 <span class="token comment">//秒 </span>
        <span class="token string-property property">&quot;q+&quot;</span> <span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//季度 </span>
        <span class="token string-property property">&quot;S&quot;</span>  <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMilliseconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span>             <span class="token comment">//毫秒 </span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span> 
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(y+)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>fmt<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fmt<span class="token operator">=</span>fmt<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>RegExp<span class="token punctuation">.</span>$1<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">-</span> RegExp<span class="token punctuation">.</span>$1<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> k <span class="token keyword">in</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">&quot;(&quot;</span><span class="token operator">+</span> k <span class="token operator">+</span><span class="token string">&quot;)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>fmt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            fmt <span class="token operator">=</span> fmt<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>RegExp<span class="token punctuation">.</span>$1<span class="token punctuation">,</span> <span class="token punctuation">(</span>RegExp<span class="token punctuation">.</span>$1<span class="token punctuation">.</span>length<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span>o<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;00&quot;</span><span class="token operator">+</span> o<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token operator">+</span> o<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">;</span> 
<span class="token punctuation">}</span>

<span class="token comment">// 调用</span>
<span class="token keyword">var</span> time1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd hh:mm:ss&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>time1<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 2021-06-07 10:41:00</span>

<span class="token keyword">var</span> time2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>time2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2021-06-07</span>
</code></pre></div><h4 id="将指定的日期转换为-年月日-的格式"><a href="#将指定的日期转换为-年月日-的格式" class="header-anchor">#</a> 将指定的日期转换为&quot;年月日&quot;的格式</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> oldTime <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token string">&quot;2012/12/25 20:11:11&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> curTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>oldTime<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>curTime<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 2021-06-07</span>
</code></pre></div><h4 id="将-时间戳-转换为-年月日-的格式"><a href="#将-时间戳-转换为-年月日-的格式" class="header-anchor">#</a> 将 &quot;时间戳&quot; 转换为 &quot;年月日&quot; 的格式</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> da <span class="token operator">=</span> <span class="token number">1402233166999</span><span class="token punctuation">;</span>
da <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>da<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> year <span class="token operator">=</span> da<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'年'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> month <span class="token operator">=</span> da<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">+</span><span class="token string">'月'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> date <span class="token operator">=</span> da<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'日'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span>year<span class="token punctuation">,</span>month<span class="token punctuation">,</span>date<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2014年-6月-8日</span>
</code></pre></div><h4 id="判断当前时间的三天范围"><a href="#判断当前时间的三天范围" class="header-anchor">#</a> 判断当前时间的三天范围</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">isShowHandle</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> td <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    td <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>td<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> td<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> td<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> od <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
    od <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>od<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> od<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> od<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> xc <span class="token operator">=</span> <span class="token punctuation">(</span>od <span class="token operator">-</span> td<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">/</span> <span class="token number">24</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>xc <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>xc <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>xc <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>xc <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>xc <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>xc <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

</code></pre></div><h2 id="js随机生成1-100的数"><a href="#js随机生成1-100的数" class="header-anchor">#</a> js随机生成1-100的数</h2> <div class="language-js extra-class"><pre class="language-js"><code>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="js下载文档"><a href="#js下载文档" class="header-anchor">#</a> js下载文档</h2> <h3 id="window-open下载文件"><a href="#window-open下载文件" class="header-anchor">#</a> window.open下载文件</h3> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;https://codeload.github.com/douban/douban-client/legacy.zip/master&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="a标签下载文件"><a href="#a标签下载文件" class="header-anchor">#</a> a标签下载文件</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 下载</span>
<span class="token keyword">function</span> <span class="token function">exportClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> FileName <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listData<span class="token punctuation">.</span>fileName<span class="token punctuation">;</span>
    <span class="token keyword">let</span> fileId <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listData<span class="token punctuation">.</span>fileId<span class="token punctuation">;</span>
    <span class="token keyword">let</span> objectUrl <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">DAMP</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/uploadAndDownLoadFile/downloadfile?fileId=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fileId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span> <span class="token comment">// 接口</span>
    <span class="token keyword">const</span> elink <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    elink<span class="token punctuation">.</span>download <span class="token operator">=</span> FileName<span class="token punctuation">;</span> <span class="token comment">//下载文件名称,</span>
    elink<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">;</span>
    elink<span class="token punctuation">.</span>href <span class="token operator">=</span> objectUrl<span class="token punctuation">;</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>elink<span class="token punctuation">)</span><span class="token punctuation">;</span>
    elink<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>elink<span class="token punctuation">.</span>href<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 释放URL 对象</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>elink<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="input标签下载文件"><a href="#input标签下载文件" class="header-anchor">#</a> input标签下载文件</h3> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">let</span> objectUrl <span class="token operator">=</span> <span class="token constant">REPORT_API</span> <span class="token operator">+</span> <span class="token string">&quot;/decision/view/report&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> form <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;form&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;target&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;_blank&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;method&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;action&quot;</span><span class="token punctuation">,</span> objectUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;input&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
input<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hidden&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 对于get请求 最终会拼成http://192.168.66.183:13666/download?name=HAP.pdf</span>
input<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;reportNo&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>report<span class="token punctuation">.</span>reportNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
input<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;dmp-token&quot;</span><span class="token punctuation">,</span> <span class="token function">getToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
input<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;viewlet&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>report<span class="token punctuation">.</span>rptDocPathPad<span class="token punctuation">)</span><span class="token punctuation">;</span>
input<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;op&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;export&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
input<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;format&quot;</span><span class="token punctuation">,</span> format<span class="token punctuation">)</span><span class="token punctuation">;</span>
input<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;sessionID&quot;</span><span class="token punctuation">,</span> sid<span class="token punctuation">)</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>form<span class="token punctuation">)</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>form<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="axios下载文件"><a href="#axios下载文件" class="header-anchor">#</a> axios下载文件</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> form <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;reportNo&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>report<span class="token punctuation">.</span>reportNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;dmp-token&quot;</span><span class="token punctuation">,</span> <span class="token function">getToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;viewlet&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>report<span class="token punctuation">.</span>rptDocPathPad<span class="token punctuation">)</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;op&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;export&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;format&quot;</span><span class="token punctuation">,</span> format<span class="token punctuation">)</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;sessionID&quot;</span><span class="token punctuation">,</span> sid<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> objectUrl <span class="token operator">=</span> <span class="token constant">REPORT_API</span> <span class="token operator">+</span> <span class="token string">&quot;/decision/view/report&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> fileName <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getLastdata</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>report<span class="token punctuation">.</span>rptDocPathPad<span class="token punctuation">,</span> formats<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$axiosDownload</span><span class="token punctuation">(</span>objectUrl<span class="token punctuation">,</span> form<span class="token punctuation">,</span> fileName<span class="token punctuation">,</span>formats<span class="token punctuation">,</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// axios的post请求 公用方法下载文件（header传参添加语言）</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">axiosDownload</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> fileName<span class="token punctuation">,</span> formats<span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">'POST'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// console.log(url, url, _this, fileName, method);</span>
    <span class="token keyword">let</span> typeFormats <span class="token operator">=</span> <span class="token string">&quot;application/x-xls&quot;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>formats <span class="token operator">==</span> <span class="token string">&quot;pdf&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        typeFormats <span class="token operator">=</span> <span class="token string">&quot;application/pdf&quot;</span>
    <span class="token punctuation">}</span>
    <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        method<span class="token punctuation">,</span>
        url<span class="token punctuation">,</span> <span class="token comment">//接口地址</span>
        data<span class="token punctuation">,</span> <span class="token comment">//接口参数</span>
        <span class="token literal-property property">responseType</span><span class="token operator">:</span> <span class="token string">&quot;blob&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">token</span><span class="token operator">:</span> <span class="token function">getToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token comment">// token: localStorage.getItem(&quot;access_token&quot;),</span>
            <span class="token string-property property">&quot;Content-Type&quot;</span><span class="token operator">:</span> typeFormats<span class="token punctuation">,</span>
            <span class="token comment">// &quot;X-Edsp-Language&quot;: Tools.getCurLocale(),</span>
            <span class="token comment">// &quot;X-Edsp-Language&quot;: &quot;en-US,fr-CA&quot;,</span>
            <span class="token string-property property">&quot;X-Edsp-Language&quot;</span><span class="token operator">:</span> <span class="token string">&quot;en-US&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">&quot;=====res====axiosDownload&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> data <span class="token operator">=</span> res<span class="token punctuation">.</span>data
        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'application/json'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            reader<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'loadend'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">const</span> <span class="token punctuation">{</span> message <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>reader<span class="token punctuation">.</span>result<span class="token punctuation">)</span>
                _this<span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">message</span><span class="token operator">:</span> message <span class="token operator">||</span> _this<span class="token punctuation">.</span><span class="token function">$i18ns</span><span class="token punctuation">(</span><span class="token string">&quot;ExportFail&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;warning&quot;</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            reader<span class="token punctuation">.</span><span class="token function">readAsText</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fileName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                fileName <span class="token operator">=</span>
                    res<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&quot;content-disposition&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;filename=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">let</span> typeFormats <span class="token operator">=</span> <span class="token string">&quot;application/x-xls&quot;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>formats <span class="token operator">==</span> <span class="token string">&quot;pdf&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                typeFormats <span class="token operator">=</span> <span class="token string">&quot;application/pdf&quot;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">let</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>res<span class="token punctuation">.</span>data<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> typeFormats <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>blob<span class="token punctuation">,</span><span class="token string">&quot;========blob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span>msSaveOrOpenBlob<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                navigator<span class="token punctuation">.</span><span class="token function">msSaveBlob</span><span class="token punctuation">(</span>blob<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">var</span> link <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                link<span class="token punctuation">.</span>href <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
                link<span class="token punctuation">.</span>download <span class="token operator">=</span> <span class="token function">decodeURI</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                link<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>link<span class="token punctuation">.</span>href<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// _this.$message({</span>
        <span class="token comment">//   message: _this.$i18ns(&quot;ExportFail&quot;),</span>
        <span class="token comment">//   type: &quot;warning&quot;,</span>
        <span class="token comment">// });</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="xhr下载文件"><a href="#xhr下载文件" class="header-anchor">#</a> xhr下载文件</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/* 
url:链接
formats：格式
docName：文件名
*/</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">xhrDownload</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> formats<span class="token punctuation">,</span>docName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// msSaveOrOpenBlob --- 下载并打开；msSaveBlob --- 下载</span>
    <span class="token comment">// var isBrowserIE = window.navigator &amp;&amp; window.navigator.msSaveOrOpenBlob;</span>
    <span class="token keyword">var</span> isBrowserIE <span class="token operator">=</span> window<span class="token punctuation">.</span>navigator <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span>msSaveBlob<span class="token punctuation">;</span>

    <span class="token comment">// var dataHref = 'https://example.com/doc.pdf';</span>
    <span class="token keyword">var</span> dataHref <span class="token operator">=</span> url<span class="token punctuation">;</span>
    <span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> typeFormats <span class="token operator">=</span> <span class="token string">&quot;application/x-xls&quot;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>formats <span class="token operator">==</span> <span class="token string">&quot;pdf&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        typeFormats <span class="token operator">=</span> <span class="token string">&quot;application/pdf&quot;</span>
    <span class="token punctuation">}</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> dataHref<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> typeFormats<span class="token punctuation">)</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">'Authorization'</span><span class="token punctuation">,</span> <span class="token string">'Bearer '</span> <span class="token operator">+</span> <span class="token function">getToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span>responseType <span class="token operator">=</span> isBrowserIE <span class="token operator">?</span> <span class="token string">'blob'</span> <span class="token operator">:</span> <span class="token string">'arraybuffer'</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//For IE11</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>isBrowserIE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// Create a new Blob object using the response data of the onload object</span>
                <span class="token keyword">var</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>response<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> typeFormats <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// var bool = window.navigator.msSaveOrOpenBlob(blob, docName);</span>
                <span class="token keyword">var</span> bool <span class="token operator">=</span> window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span><span class="token function">msSaveBlob</span><span class="token punctuation">(</span>blob<span class="token punctuation">,</span> docName<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>bool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;Download failed, Please try again later&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">var</span> uInt8Array <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> i <span class="token operator">=</span> uInt8Array<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
                <span class="token keyword">var</span> binaryString <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    binaryString<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>uInt8Array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">var</span> data <span class="token operator">=</span> binaryString<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">var</span> base64 <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">btoa</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">var</span> dataUrl <span class="token operator">=</span> <span class="token string">'data:application/octet-stream;charset=utf-16le;base64,'</span> <span class="token operator">+</span> base64<span class="token punctuation">;</span>
                <span class="token keyword">var</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                element<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'href'</span><span class="token punctuation">,</span> dataUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
                element<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'download'</span><span class="token punctuation">,</span> docName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span><span class="token punctuation">;</span>
                document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>
                element<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;Download failed, Please try again later&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">closeWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="js计算字符串的长度"><a href="#js计算字符串的长度" class="header-anchor">#</a> js计算字符串的长度</h2> <p>生成span标签输入内容，然后获取span标签的width，从而得到str的width</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">getTextWidthAndHeight</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> fontSize <span class="token operator">=</span> <span class="token string">'11px'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> span <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    span<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'inline-block'</span>
    span<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> str<span class="token punctuation">;</span>
    span<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span> fontSize<span class="token punctuation">;</span>
    <span class="token comment">// span.style.lineHeight = &quot;1em&quot;;</span>
    span<span class="token punctuation">.</span>style<span class="token punctuation">.</span>padding <span class="token operator">=</span> <span class="token string">&quot;0px&quot;</span><span class="token punctuation">;</span>
    span<span class="token punctuation">.</span>style<span class="token punctuation">.</span>margin <span class="token operator">=</span> <span class="token string">&quot;0px&quot;</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>span<span class="token punctuation">)</span>
    <span class="token keyword">var</span> obj <span class="token operator">=</span> span<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> width <span class="token operator">=</span> obj<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
    <span class="token keyword">var</span> height <span class="token operator">=</span> obj<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
    span<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        width<span class="token punctuation">,</span>
        height
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="数字要用千分位来表示-三位数之间要用逗号分隔"><a href="#数字要用千分位来表示-三位数之间要用逗号分隔" class="header-anchor">#</a> 数字要用千分位来表示，三位数之间要用逗号分隔</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">format_number</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> len <span class="token operator">=</span> b<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>len<span class="token operator">&lt;=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> b<span class="token punctuation">;</span><span class="token punctuation">}</span>
  <span class="token keyword">var</span> r<span class="token operator">=</span>len<span class="token operator">%</span><span class="token number">3</span><span class="token punctuation">;</span>
  <span class="token comment">// b.slice(r,len).match(/\d{3}/g).join(&quot;,&quot;) 每三位数加一个逗号。</span>
  <span class="token keyword">return</span> r <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> b<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;,&quot;</span><span class="token operator">+</span>b<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\d{3}</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span>
  <span class="token operator">:</span> b<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\d{3}</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="对数据进行重新排序"><a href="#对数据进行重新排序" class="header-anchor">#</a> 对数据进行重新排序</h2> <h3 id="对象数组的排序"><a href="#对象数组的排序" class="header-anchor">#</a> 对象数组的排序</h3> <p>原数组：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token literal-property property">count</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'小米'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token literal-property property">count</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'华为'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token literal-property property">count</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'苹果'</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sortBy</span> <span class="token punctuation">(</span><span class="token parameter">field</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//根据传过来的字段进行排序</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> x<span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">-</span> y<span class="token punctuation">[</span>field<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>排序后的数组：</p> <div class="language-js extra-class"><pre class="language-js"><code>arr1<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token function">sortBy</span><span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token comment">//[{count:1,name:'小米'},{count:2,name:'苹果'},{count:3,name:'华为'}]</span>
</code></pre></div><h3 id="自定义数据进行排列"><a href="#自定义数据进行排列" class="header-anchor">#</a> 自定义数据进行排列</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">sortArr</span><span class="token punctuation">(</span><span class="token parameter">word</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> new_word <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>word<span class="token punctuation">]</span>
    <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string-property property">'主'</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">'领'</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">'报'</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string-property property">'客'</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string-property property">'决'</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string-property property">'挖'</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string-property property">'外'</span><span class="token operator">:</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token keyword">in</span> word<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> word1 <span class="token operator">=</span> word<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>instName<span class="token punctuation">;</span>
        <span class="token keyword">let</span> word3 <span class="token operator">=</span> obj<span class="token punctuation">[</span>word1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        new_word<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>sortId <span class="token operator">=</span> word3<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    new_word<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> a<span class="token punctuation">.</span>sortId <span class="token operator">-</span> b<span class="token punctuation">.</span>sortId
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> new_word
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="数组从大到小排序-去除重复值"><a href="#数组从大到小排序-去除重复值" class="header-anchor">#</a> 数组从大到小排序，去除重复值</h3> <h5 id="编写一个方法-该方法接收两个参数-分别为-k-和-一个无序的纯数字数组。该方法在执行后-会返回数组中第-k-大的数字。特别注意-如果数组中-有两位数值一样的数字-同数值数字排名并列。如-3-1-3-2-5-4-5-中-第-1-大的数字为-5-第2大的数字为-4-第5大的数字为-1"><a href="#编写一个方法-该方法接收两个参数-分别为-k-和-一个无序的纯数字数组。该方法在执行后-会返回数组中第-k-大的数字。特别注意-如果数组中-有两位数值一样的数字-同数值数字排名并列。如-3-1-3-2-5-4-5-中-第-1-大的数字为-5-第2大的数字为-4-第5大的数字为-1" class="header-anchor">#</a> 编写一个方法，该方法接收两个参数，分别为 k 和 一个无序的纯数字数组。该方法在执行后，会返回数组中第 k 大的数字。特别注意，如果数组中，有两位数值一样的数字，同数值数字排名并列。如 [3,1,3,2,5,4,5] 中，第 1 大的数字为 5，第2大的数字为 4，第5大的数字为 1？</h5> <p>这道题目考察数组的常用基本操作方法。思路是先做数组内部值的排序，排序完成之后因为需要由大到小所以在反转下数组 。最后在做数组的去重处理，最终返还答案。实现代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getNum</span><span class="token punctuation">(</span><span class="token parameter">k<span class="token punctuation">,</span> arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 排列数组及反转</span>
    <span class="token keyword">let</span> res <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>b<span class="token operator">-</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 将数组转化成set去重</span>
    <span class="token keyword">let</span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 将类数组转回数组</span>
    <span class="token keyword">let</span> newArr <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> newArr<span class="token punctuation">[</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token string">&quot;undefined&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 返回查找到的数据</span>
        <span class="token keyword">return</span> newArr<span class="token punctuation">[</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 未找到数据排除错误</span>
        <span class="token keyword">throw</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;未找到对应数据&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token function">getNum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="循环的终止"><a href="#循环的终止" class="header-anchor">#</a> 循环的终止</h2> <h3 id="break和continue的区别"><a href="#break和continue的区别" class="header-anchor">#</a> break和continue的区别</h3> <ol><li>语句作用不同
<ol><li>break：在分支结构程序设计中用break语句可以使流程跳出switch结构，继续执行switch语句下面的一个语句；break语句可以用来从循环体内中途跳出循环体，即提前结束循环操作，接着执行循环下面的语句。</li> <li>continue：continue语句是跳过循环体中剩余的语句而强制执行下一次循环操作。其作用为结束本次循环，即跳过循环体中下面尚未执行的语句，接着进行下一次是否执行循环的判定。</li></ol></li> <li>用法不同
<ol><li>break：在循环语句中，break语句一般都是与if语句一起使用；break语句不能用于循环语句和switch语句之外的任何其它语句中。</li> <li>continue：continue语句只能用在循环语句中。一般都是与if语句一起使用。</li></ol></li> <li>判断不同
<ol><li>break：break语句是结束整个循环过程，不再判断执行循环的条件是否成立。</li> <li>continue：continue语句只结束本次循环，而不是终止整个循环的执行</li></ol></li></ol> <h2 id="xss攻击防范"><a href="#xss攻击防范" class="header-anchor">#</a> XSS攻击防范</h2> <h3 id="前端安全系列之xss攻击防范"><a href="#前端安全系列之xss攻击防范" class="header-anchor">#</a> 前端安全系列之xss攻击防范</h3> <ol><li>使用textContent</li> <li>使用html转义
<ol><li>把js中的标签转成字符</li></ol></li> <li>对于链接转跳 禁止含有‘Javascript:’开头的字符</li> <li>标签属性中含有恶意执行代码 JavaScript</li> <li>如果用户输入的文本进行过滤很容易照成注入漏洞</li> <li>什么是xss攻击
<ol><li>cross-site scriping(跨站脚本攻击)为和css区分所以叫xss攻击</li></ol></li> <li>xss攻击的本质
<ol><li>代码未经过滤，混入正常代码中，浏览器无法分辨，导致恶意代码被执行</li></ol></li> <li>在处理输入时，以下内容都不可信
<ol><li>来自用户的UGC信息</li> <li>来自第三方的链接</li> <li>URL参数</li> <li>POST参数</li> <li>referer（可能来自不可信的来源）</li> <li>cookie（可能来自其他子域注入）</li></ol></li> <li>XSS分类
<ol><li>根据攻击来源可分为三种：储存型、反射型、DOM型；
<ol><li>储存型
<ol><li>攻击者将恶意代码提交到目标网站的数据库中，用户打开目标网站时，网站服务端将恶意代码从数据库取出，拼接在HTML中返回给浏览器</li> <li>用户浏览器接收到响应后解析执行，混在其中的恶意代码也被执行，恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作</li> <li>常见操作带有用户保存数据的网站功能，如论坛发帖、商品评论、用户私信等</li></ol></li> <li>反射型
<ol><li>攻击者构造出特殊的URL，其中包含恶意代码，用户打开带有恶意代码的URL时，网站服务端将恶意代码从URL中取出，拼接在HTML中返回给浏览器</li> <li>反射型XSS跟储存型XSS的区别是：储存型XSS的恶意代码存在数据库里，反射型XSS的恶意代码存在URL里</li> <li>反射型XSS漏洞常见于通过URL传递参数的功能，如：网站搜索、跳转等</li></ol></li> <li>DOM型
<ol><li>攻击者构造出特殊的URL，其中包含恶意代码，用户打开带有恶意代码的URL，用户浏览器接收到响应后解析执行，前端JavaScript取出URL中的恶意代码并执行</li> <li>DOM型XSS跟前两种XSS的区别：DOM型XSS攻击中，取出和执行恶意代码由浏览器端完成，属于前端JavaScript自身的安全漏洞，而其他两种XSS都属于服务端的安全漏洞</li></ol></li></ol></li></ol></li> <li>XSS攻击预防
<ol><li>包含两大要素
<ol><li>攻击者提交恶意代码</li> <li>浏览器执行恶意代码</li></ol></li> <li>两种方式
<ol><li>纯前端渲染（当前主流形式）
<ol><li>浏览器先加载一个静态HTML，此HTML中不包含任务跟业务相关的数据，然后浏览器执行HTML中的JavaScript，JavaScript通过Ajax加载业务数据，调用DOM API更新到页面上</li> <li>但纯前端渲染还需注意避免DOM型XSS漏洞</li> <li>使用.innerHTML、.outerHTML、document.write()要小心；应尽量使用textContent；如果用vue/react技术栈，并且不适用x-html、dangerouslyInnerHTML功能，就在前端render阶段避免innerHTML、outerHTML的XSS隐患</li></ol></li> <li>转义HTML
<ol><li>Java工程里，常用的转义库为org.owasp.encoder</li></ol></li></ol></li></ol></li></ol> <h3 id="v-html防止xss注入"><a href="#v-html防止xss注入" class="header-anchor">#</a> v-html防止xss注入</h3> <p>vue-dompurify-html 插件</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># 安装</span>
cnpm <span class="token function">install</span> vue-dompurify-html

<span class="token comment"># 引⼊</span>
<span class="token function">import</span> VueDOMPurifyHTML from<span class="token string">'vue-dompurify-html'</span>
Vue.use<span class="token punctuation">(</span>VueDOMPurifyHTML<span class="token punctuation">)</span>

<span class="token comment"># 使用</span>
<span class="token operator">&lt;</span>div v-dompurify-html<span class="token operator">=</span><span class="token string">&quot;rawHtml&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">为什么使⽤vue-dompurify-html，不⽤XSS插件呢？</p> <p>因为使⽤XSS插件他会把除了标签和内容之外的所有东西都给过滤掉，⽐如class，style这样过滤掉后富⽂本的样式就没有了，美观度⼀下就降低了</p></div> <h2 id="this相关"><a href="#this相关" class="header-anchor">#</a> this相关</h2> <h3 id="call-apply-bind-的区别和作用-bind-方法如何来实现"><a href="#call-apply-bind-的区别和作用-bind-方法如何来实现" class="header-anchor">#</a> <code>call(), .apply() .bind()</code> 的区别和作用？bind 方法如何来实现？</h3> <p>call 、apply 、bind 作用是 改变函数执行时的上下文，简而言之就是改变函数运行时的this指向。区别在于调用方式及参数传递上。具体如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// fn函数默认this指向是 window对象</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">myname</span><span class="token operator">:</span><span class="token string">&quot;张三&quot;</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// this 会变成 传入的obj ，args 会变成[1,2];</span>
<span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// this会变成传入的obj ，传入的参数必须是一个数组；</span>
<span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// this 也会变成传入的obj ，bind不是立即执行需要执行一次</span>
</code></pre></div><p>综上所述call、apply、bind都可以改变this指向，区别在于 参数传递方式不同，call、apply是立即执行bind不是立即执行。
bind实现如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myBind</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// 判断调用对象是否为函数</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span> <span class="token operator">!==</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">&quot;Error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token comment">// 获取参数</span>
   <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     fn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

   <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

     <span class="token comment">// 根据调用方式，传入不同绑定值</span>
     <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">Fn</span> <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>arguments<span class="token punctuation">)</span> <span class="token operator">:</span> context<span class="token punctuation">,</span> args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token operator">...</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token punctuation">}</span>

 <span class="token punctuation">}</span>
</code></pre></div><h3 id="如何判断this-箭头函数的this是什么"><a href="#如何判断this-箭头函数的this是什么" class="header-anchor">#</a> 如何判断this？箭头函数的this是什么？</h3> <p>可以分成三种场景来描述this。
1、函数直接调用中的this。例如：</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如上this会指向window，需要注意下在严格模式下this会是undefined情况，同样也需要注意在script标签type=&quot;module&quot;下也回是undefined。
2.在对象里调用的情况：如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">myname</span><span class="token operator">:</span><span class="token string">&quot;对象&quot;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">foo</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//this会指向调用的对象</span>
</code></pre></div><p>3.在构造函数及类中this会指向实例化的对象。如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;张三&quot;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> zhangsan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
zhangsan<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//this指向实例化对象zhangsan</span>


<span class="token keyword">class</span> <span class="token class-name">Animal</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> xiaoqiang <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token string">&quot;小强&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xiaoqiang<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//this 会指向xiaoqiang</span>
</code></pre></div><p>最后箭头函数不会创建自己的this,它只会从自己的作用域链的上一层继承this。</p> <h2 id="js-禁止退出当前页面"><a href="#js-禁止退出当前页面" class="header-anchor">#</a> js 禁止退出当前页面</h2> <p>window.history.pushState()    // 意思是 给窗体添加一条历史记录 //history 历史的意思，pushState () 推动状态 ，方法意思是在历史记录中增加一条新的记录；</p> <p>window.history.replaceState()   //replaceState () 替换状态，方法意思是将当前的历史记录给替换掉，传说中的夺舍重生！</p> <p>* 这两方法分别有 3 个参数：
* state：一个与指定网址相关的状态对象，popstate 事件触发时，该对象会传入回调函数。如果不需要这个对象，此处可以填 null。
* title：新页面的标题，但是所有浏览器目前都忽略这个值，就像你保存页面要你输入标题，因此这里可以填 null。
* url：新的网址，必须与当前页面处在同一个域。浏览器的地址栏将显示这个网址。一般使用 #，来存放当前地址
*
* popstate 事件 ：每当活动历史记录条目在同一文档的两个历史记录条目之间发生变化时，就会将事件分派到窗口。
* 也就是说窗体加载时不会触发 popstate 事件，只有当地址栏发生改变时才会触发 popstate 事件</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;script&gt;
　　function pushHistory() {
　　　　var state = {
　　　　　　title: &quot;title&quot;,
　　　　　　url: &quot;#&quot;
　　　　};
　　window.history.pushState(state, &quot;title&quot;, &quot;#&quot;); // 大家都应该知道 #就代表当前连接，这里是 给地址栏添加一条当前地址的历史记录
　　}
　　pushHistory(); // 页面第一次加载，先给地址栏赋个历史记录
　　// 由于上面只能赋值一次，所以需要通过 popstate 事件触发时，来进行回调这个方法
　　window.addEventListener(&quot;popstate&quot;, function(e) { // 给窗体添加一个 popstate 事件触发时 来回调历史记录方法
　　　　pushHistory();
　　})
&lt;/script&gt;
</code></pre></div><h2 id="清除网页历史记录-屏蔽后退按钮"><a href="#清除网页历史记录-屏蔽后退按钮" class="header-anchor">#</a> 清除网页历史记录，屏蔽后退按钮!</h2> <p>window.history.forward(1); ===== 前进一页</p> <h2 id="微信链接重定向之后后退两次才能退出当前页面问题解决"><a href="#微信链接重定向之后后退两次才能退出当前页面问题解决" class="header-anchor">#</a> 微信链接重定向之后后退两次才能退出当前页面问题解决</h2> <p>需求：微信内多个H5页面分享出去指定到同一链接</p> <p>具体实现方式：纯前端实现多个微信H5页面分享出去指定到同一连接；</p> <p>页面重定向之后发现在微信里点击后退之后，又会重新返回这个页面，必须要连续快速的点击返回才能退出关闭浏览器，</p> <p>这个用户体验就非常不好，</p> <p>我们可以手动给浏览器新加一条空的浏览记录‘#’，</p> <p>然后监控这个#链接，当返回到这个链接的时候，说明用户已经做了后退操作，然后调用微信的jsdk方法来关闭微信浏览器，</p> <p>这样就实现了点击一次后退就直接退出；</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">pushHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;popstate&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        wx<span class="token punctuation">.</span><span class="token function">closeWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">function</span> <span class="token function">pushHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token keyword">var</span> state <span class="token operator">=</span> <span class="token punctuation">{</span> 
            <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> 
            <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;#&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span> 
        window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/%E5%89%8D%E7%AB%AF%E9%97%AE%E9%A2%98/" class="prev router-link-active">
        前端问题
      </a></span> <span class="next"><a href="/前端问题/前端基础/htmlBase.html">
        html基础
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8914b41c.js" defer></script><script src="/assets/js/3.7f8ab6bd.js" defer></script><script src="/assets/js/73.ff13867e.js" defer></script>
  </body>
</html>
